# ╔══════════════════════════════════════════════════════════════╗
# ║            THERMODUCT PORTAL — CONFIGURATION               ║
# ╠══════════════════════════════════════════════════════════════╣
# ║  Copy to .env and adjust values for your environment.       ║
# ║  All WEBHOOK_ paths are relative to API_BASE_URL unless     ║
# ║  they start with http(s)://.                                ║
# ╚══════════════════════════════════════════════════════════════╝

# ── App Settings ──────────────────────────────────────────────
APP_TITLE=Thermoduct Portal
APP_PORT=8080

# ── Authentication (Keycloak OIDC + PKCE) ────────────────────
# The portal redirects to Keycloak for login. No client secret needed.
# Keycloak handles username/password, MFA, SSO, etc.
#
#   FLOW:
#   Browser → Keycloak login page → callback.html → tokens in sessionStorage
#
AUTH_ISSUER=https://auth.thermoduct.be/realms/thermoduct
AUTH_CLIENT_ID=installer-portal
AUTH_REDIRECT_URI=https://portal.thermoduct.be/callback.html
AUTH_POST_LOGOUT_URI=https://portal.thermoduct.be/index.html
AUTH_SCOPES=openid profile email roles

# ── API Base URL ─────────────────────────────────────────────
# All webhook paths below are appended to this base
API_BASE_URL=https://46.225.76.46/n8n/webhook

# ── Outgoing Webhooks (n8n) ──────────────────────────────────
#
#   PATHWAY                          METHOD   AUTH     DESCRIPTION
#   ─────────────────────────────    ──────   ──────   ───────────────────────────────
#   {WEBHOOK_TASKS}/tasks            GET      Bearer   List all tasks for logged-in user
#   {WEBHOOK_TASKS}/task-info        GET      Bearer   Task detail + description (fast)
#   {WEBHOOK_TASKS}/task-docs        GET      Bearer   Task documents / PDFs (slow)
#   {WEBHOOK_FOLDERS}?project_id=    GET      Bearer   Folder tree (Gebouw/Verdiep/Collector)
#   {WEBHOOK_FILES}?project_id=&..   GET      Bearer   List files in a folder
#   {WEBHOOK_SERVE_FILE}?..          GET      —        Serve/download a file (public)
#   {WEBHOOK_FILE_DELETE}            POST     Bearer   Delete a file { project_id, folder_path, file_name }
#   {WEBHOOK_UPLOAD_FORM}?..         GET      —        Opens n8n upload form in popup
#
# ── Incoming to this portal ──────────────────────────────────
#
#   PATH                  FROM         DESCRIPTION
#   ────────────────────  ───────────  ─────────────────────────────────────
#   /                     Browser      Main app (index.html)
#   /callback.html        Keycloak     OIDC redirect after login (exchanges code for tokens)
#

# Tasks — full URL (new n8n instance with Keycloak auth subflow)
WEBHOOK_TASKS=https://n8n.thermoduct.be/webhook
WEBHOOK_FOLDERS=/thermoduct-folders
WEBHOOK_FILES=/thermoduct-files
WEBHOOK_SERVE_FILE=/thermoduct-serve-file
WEBHOOK_FILE_DELETE=/thermoduct-file-delete

# Collectors — full URL via n8n.thermoduct.be (same base as tasks, has CORS)
WEBHOOK_COLLECTORS=https://n8n.thermoduct.be/webhook/thermoduct-collectors

# Upload form — full URL (different base path: /n8n/form/)
WEBHOOK_UPLOAD_FORM=https://46.225.76.46/n8n/form/c939dab0-c13d-4f51-95b7-50ddc4068880

# PDF upload — project leaders upload plans to Odoo (Bearer auth)
# POST   { project_id, filename, data }  → upload file to Odoo
# DELETE { project_id, filename }         → delete file from Odoo
WEBHOOK_PDF_UPLOAD=/thermoduct-pdf-upload

# Collector photos — installers upload photos per collector to server (not Odoo)
# GET    ?project_id=&collector_id=                    → list photos
# POST   { project_id, collector_id, filename, data }  → upload photo
# DELETE { project_id, collector_id, filename }         → delete photo
WEBHOOK_COLLECTOR_PHOTOS=/thermoduct-collector-photos

# Lookup endpoints — batch-resolve IDs to names/addresses
# GET ?ids=1,2,3 → [{ id, name }]
WEBHOOK_LOOKUP_INSTALLERS=/tasks-installers
# GET ?ids=1,2,3 → [{ id, project_name }]
WEBHOOK_LOOKUP_SALES_ORDERS=/sales-orders
# GET ?ids=1,2,3 → [{ id, street, city, zip }]
WEBHOOK_LOOKUP_ADDRESSES=/addresses
